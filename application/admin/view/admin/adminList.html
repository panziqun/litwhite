<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title></title>
    <meta name="keywords" content="">
    <meta name="description" content="">

    <link rel="shortcut icon" href="favicon.ico"> <link href="__ADMIN_CSS__/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="__ADMIN_CSS__/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="__ADMIN_CSS__/animate.css" rel="stylesheet">
    <link href="__ADMIN_CSS__/style.css?v=4.1.0" rel="stylesheet">

</head>

<body class="gray-bg">
    <div class="wrapper wrapper-content animated fadeInRight">
        
        <div class="row" >
            <div class="col-sm-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>管理员简介</h5>
                    </div>
                    <div class="ibox-content">
                        <p>jquery.validate.js 是一款优秀的jQuery表单验证插件。它具有如下特点：</p>
                        <ul>
                            <li>安装简单</li>
                            <li>内置超过20种数据验证方法</li>
                            <li>直列错误提示信息</li>
                            <li>可扩展的数据验证方法</li>
                            <li>使用内置的元数据或插件选项来指定您的验证规则</li>
                            <li>优雅的交互设计</li>
                        </ul>
                        <p>官网：<a href="http://jqueryvalidation.org/" target="_blank">http://jqueryvalidation.org/</a>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>添加管理员</h5>
                    </div>
                    <div class="ibox-content">
                        <form class="form-horizontal m-t" id="commentForm">
                            <div class="form-group">
                                <label class="col-sm-3 control-label">管理员：</label>
                                <div class="col-sm-8">
                                    <input id="cname" name="adminlist_name" minlength="2" type="text" class="form-control" required="" aria-required="true"><span></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">密码：</label>
                                <div class="col-sm-8">
                                    <input id="cemail" type="text" class="form-control" name="adminlist_pwd" required="" aria-required="true">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">联系方式：</label>
                                <div class="col-sm-8">
                                    <input id="curl" type="text" class="form-control" name="adminlist_phone" required=""  >
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-4 col-sm-offset-3">
                                    <button class="btn btn-primary submit" type="submit">提交</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-sm-8">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>管理员列表</h5>
                    </div>
                    <div class="ibox-content">

                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>管理员</th>
                                    <th>联系方式</th>
                                    <th>部门</th>
                                    <th>管理</th>
                                </tr>
                            </thead>
                            <tbody>
                                {foreach $adminList as $key => $value}
                                <tr>
                                    <td>{$value['adminlist_id']}</td>
                                    <td>{$value['adminlist_name']}</td>
                                    <td>{$value['adminlist_phone']}</td>
                                    <td>
										<select style="width:100px;" class="roleSelect" id="{$value['adminlist_id']}">
											<option>选择部门</option>
                                            {foreach $adminRoles as $v}
											<option value="{$v['adminrole_id']}">
                                            {$v['adminrole_name']}</option>
                                            {/foreach}
										</select>
                                        <span>{$value['adminrole_name']}</span>
                                    </td>
                                    <td>
                                    	<button type="button" class="btn btn-outline btn-primary update-admin" data-toggle="modal" data-target="#updateinfo" adminlist_id="{$value['adminlist_id']}">修改</button>
                                    	<button type="button" class="btn btn-outline btn-warning">删除</button>
                                    </td>
                                </tr>
                                {/foreach}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!-- 模态窗口 管理员信息修改 -->
    <div class="modal inmodal fade" id="updateinfo" tabindex="-1" role="dialog"  aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only"></span></button>
                    <h4 class="modal-title" style="font-size:15px;">管理员信息修改</h4>
                </div>
                <div class="modal-body">
                    <form>
                        <p>管理员&emsp;：<input type="text" name=""  class="update-list1" admininputid=''></p>
                        <p>密码&emsp;&emsp;：<input type="text" name="" class="update-list2"></p>
                        <p>联系方式：<input type="text" name="" class="update-list3"></p>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-white adminexit" data-dismiss="modal">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 全局js -->
    <script src="__ADMIN_JS__/jquery.min.js?v=2.1.4"></script>
    <script src="__ADMIN_JS__/bootstrap.min.js?v=3.3.6"></script>

    <!-- 自定义js -->
    <script src="__ADMIN_JS__/content.js?v=1.0.0"></script>

    <!-- jQuery Validation plugin javascript-->
    <script src="__ADMIN_JS__/plugins/validate/jquery.validate.min.js"></script>
    <script src="__ADMIN_JS__/plugins/validate/messages_zh.min.js"></script>

    <script src="__ADMIN_JS__/demo/form-validate-demo.js"></script>
</body>
</html>
<script type="text/javascript">
    $(function(){
        //修改
        $('.update-admin').click(function(){
            $.get('{:url("adminUpdate")}',{adminlist_id:$(this).attr('adminlist_id')},function(data){
                $('.update-list1').val(data.adminlist_name);
                $('.update-list1').attr('admininputid',$(this).attr('adminlist_id'));
                $('.update-list3').val(data.adminlist_phone);
                $('input[type="hidden"]').val($(this).attr('adminlist_id'));
            },'json');
        });
        $('.adminexit').click(function(){
            console.log($('.update-list1').attr('admininputid'));
            $.post('{:url("adminUpdate")}',{adminlist_id:$('.update-list1').attr('admininputid'),adminlist_name:$('.update-list1').val(),adminlist_pwd:$('.update-list2').val(),adminlist_phone:$('.update-list3').val()},function(){
                // window.location.href = "{:url('adminList')}";
            },'json');
        });
        //判断用户名是否存在
        $('input[name="adminlist_name"]').blur(function(){
            if ($('input[name="adminlist_name"]').val() == '') {
                $('input[name="adminlist_name"] + span').text('');
            }else{
                $.get("{:url('adminAdd')}", {adminlist_name:$('input[name="adminlist_name"]').val()}, function(data){
                    $('input[name="adminlist_name"] + span').text(data.data);
                },'json');
            }
        });
        //点击注册
        $('.submit').click(function(){
            if ($('input[name="adminlist_name"]').val() == '' || $('input[name="adminlist_pwd"]').val() == '' || $('input[name="adminlist_phone"]').val() == '') {
                alert('请填写完整！');
            }else{
                $.post("{:url('adminAdd')}",{adminlist_name:$('input[name="adminlist_name"]').val(), adminlist_pwd:$('input[name="adminlist_pwd"]').val(),adminlist_phone:$('input[name="adminlist_phone"]').val()}, function(){
                    window.location.href = "{:url('adminAdd')}";
                }, 'json');
            }
        });
        //部门选择ajax
        $('.roleSelect').change(function(){
            if ($(this).val() != '选择部门') {
                $(this).val();
                $(this).attr('id');
                $.post('{:url("adminList")}',{roleSelect_adminid:$(this).attr('id'),roleSelect_roleid:$(this).val()},function(){
                    window.location.href = "{:url('adminList')}";
                },'json');
            }
        });
    });
</script>
